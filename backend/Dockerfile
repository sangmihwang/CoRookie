# APP
FROM azul/zulu-openjdk:17-latest
WORKDIR /app

COPY build/libs/corookie-0.0.1-SNAPSHOT.jar .

ARG KAKAO_CLIENT_ID
ARG KAKAO_CLIENT_SECRET
ARG GOOGLE_CLIENT_ID
ARG GOOGLE_CLIENT_SECRET
ARG GITHUB_CLIENT_ID
ARG GITHUB_CLIENT_SECRET
ARG S3_ACCESS_KEY
ARG S3_SECRET_KEY
ARG VITO_ACCESS_KEY
ARG VITO_SECRET_KEY
ARG AI_DOMAIN
ARG JWT_SECRET

ENV KAKAO_CLIENT_ID=$KAKAO_CLIENT_ID
ENV KAKAO_CLIENT_SECRET=$KAKAO_CLIENT_SECRET
ENV GOOGLE_CLIENT_ID=$GOOGLE_CLIENT_ID
ENV GOOGLE_CLIENT_SECRET=$GOOGLE_CLIENT_SECRET
ENV GITHUB_CLIENT_ID=$GITHUB_CLIENT_ID
ENV GITHUB_CLIENT_SECRET=$GITHUB_CLIENT_SECRET
ENV S3_ACCESS_KEY=$S3_ACCESS_KEY
ENV S3_SECRET_KEY=$S3_SECRET_KEY
ENV VITO_ACCESS_KEY=$VITO_ACCESS_KEY
ENV VITO_SECRET_KEY=$VITO_SECRET_KEY
ENV AI_DOMAIN=$AI_DOMAIN
ENV JWT_SECRET=$JWT_SECRET

USER root
RUN chmod +x corookie-0.0.1-SNAPSHOT.jar
ENTRYPOINT [\
    "java",\
    "-jar",\
    "-Djava.security.egd=file:/dev/./urandom",\
    "-Dsun.net.inetaddr.ttl=0",\
    "-Dspring.profiles.active=dev",\
    "corookie-0.0.1-SNAPSHOT.jar"\
]